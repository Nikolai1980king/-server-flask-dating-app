# üîí –°–∏—Å—Ç–µ–º–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π —É—Å—Ç—Ä–æ–π—Å—Ç–≤

## –û–ø–∏—Å–∞–Ω–∏–µ

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∞–Ω–∫–µ—Ç —Å –æ–¥–Ω–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–≥–æ –±—Ä–∞—É–∑–µ—Ä–∞.

## –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–ø–µ—á–∞—Ç–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
–°–∏—Å—Ç–µ–º–∞ —Å–æ–∑–¥–∞–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π "–æ—Ç–ø–µ—á–∞—Ç–æ–∫" —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ:
- User-Agent –±—Ä–∞—É–∑–µ—Ä–∞
- Accept-Language –∑–∞–≥–æ–ª–æ–≤–∫–∞
- Accept-Encoding –∑–∞–≥–æ–ª–æ–≤–∫–∞
- –†–∞–∑—Ä–µ—à–µ–Ω–∏—è —ç–∫—Ä–∞–Ω–∞ (–∏–∑ JavaScript)
- –ß–∞—Å–æ–≤–æ–≥–æ –ø–æ—è—Å–∞ (–∏–∑ JavaScript)
- –ü–ª–∞—Ç—Ñ–æ—Ä–º—ã (–∏–∑ JavaScript)
- –Ø–∑—ã–∫–∞ –±—Ä–∞—É–∑–µ—Ä–∞ (–∏–∑ JavaScript)

### 2. –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
–í—Å–µ –¥–∞–Ω–Ω—ã–µ –æ–±—ä–µ–¥–∏–Ω—è—é—Ç—Å—è –≤ —Å—Ç—Ä–æ–∫—É –∏ —Ö–µ—à–∏—Ä—É—é—Ç—Å—è —Å –ø–æ–º–æ—â—å—é SHA-256 –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞.

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
–ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ —Å–æ–∑–¥–∞—Ç—å –∞–Ω–∫–µ—Ç—É —Å–∏—Å—Ç–µ–º–∞:
1. –°–æ–∑–¥–∞–µ—Ç –æ—Ç–ø–µ—á–∞—Ç–æ–∫ —Ç–µ–∫—É—â–µ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
2. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –µ—Å—Ç—å –ª–∏ —É–∂–µ –∞–Ω–∫–µ—Ç–∞, –ø—Ä–∏–≤—è–∑–∞–Ω–Ω–∞—è –∫ —ç—Ç–æ–º—É –æ—Ç–ø–µ—á–∞—Ç–∫—É
3. –ï—Å–ª–∏ –µ—Å—Ç—å - –±–ª–æ–∫–∏—Ä—É–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –∞–Ω–∫–µ—Ç—ã
4. –ï—Å–ª–∏ –Ω–µ—Ç - —Ä–∞–∑—Ä–µ—à–∞–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ –∏ –ø—Ä–∏–≤—è–∑—ã–≤–∞–µ—Ç –∞–Ω–∫–µ—Ç—É –∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤—É

## –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü–∞ Device
```sql
CREATE TABLE device (
    id INTEGER PRIMARY KEY,
    device_fingerprint VARCHAR UNIQUE NOT NULL,
    user_agent VARCHAR,
    screen_resolution VARCHAR,
    timezone VARCHAR,
    language VARCHAR,
    platform VARCHAR,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    last_used DATETIME DEFAULT CURRENT_TIMESTAMP,
    profile_id VARCHAR
);
```

## API –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã

### POST /api/check-device-restriction
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞.

**–ó–∞–ø—Ä–æ—Å:**
```json
{
    "screen_resolution": "1920x1080",
    "timezone": "Europe/Moscow",
    "platform": "Win32",
    "language": "ru-RU"
}
```

**–û—Ç–≤–µ—Ç:**
```json
{
    "can_create": true,
    "existing_profile_id": null,
    "device_fingerprint": "a1b2c3d4e5f6...",
    "device_info": {
        "user_agent": "Mozilla/5.0...",
        "screen_resolution": "1920x1080",
        "timezone": "Europe/Moscow",
        "language": "ru-RU",
        "platform": "Win32"
    }
}
```

### GET /api/device-stats
–ü–æ–ª—É—á–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º.

**–û—Ç–≤–µ—Ç:**
```json
{
    "total_devices": 15,
    "devices_with_profiles": 12,
    "devices_without_profiles": 3,
    "restriction_active": true
}
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ—Å—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
–î–æ—Å—Ç—É–ø–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å—É: `/test-device-restriction`

–§—É–Ω–∫—Ü–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
- –ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
- –°–æ–∑–¥–∞—Ç—å –æ—Ç–ø–µ—á–∞—Ç–æ–∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
- –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–æ–∑–¥–∞—Ç—å –∞–Ω–∫–µ—Ç—É
- –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —É—Å—Ç—Ä–æ–π—Å—Ç–≤

### –°—Ü–µ–Ω–∞—Ä–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

1. **–°–æ–∑–¥–∞–Ω–∏–µ –ø–µ—Ä–≤–æ–π –∞–Ω–∫–µ—Ç—ã:**
   - –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ –ª—é–±–æ–º –±—Ä–∞—É–∑–µ—Ä–µ
   - –°–æ–∑–¥–∞—Ç—å –∞–Ω–∫–µ—Ç—É
   - ‚úÖ –î–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å

2. **–ü–æ–ø—ã—Ç–∫–∞ —Å–æ–∑–¥–∞—Ç—å –≤—Ç–æ—Ä—É—é –∞–Ω–∫–µ—Ç—É –≤ —Ç–æ–º –∂–µ –±—Ä–∞—É–∑–µ—Ä–µ:**
   - –ü–æ–ø—ã—Ç–∞—Ç—å—Å—è —Å–æ–∑–¥–∞—Ç—å –µ—â–µ –æ–¥–Ω—É –∞–Ω–∫–µ—Ç—É
   - ‚ùå –î–æ–ª–∂–Ω–æ –±—ã—Ç—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ

3. **–ü–æ–ø—ã—Ç–∫–∞ —Å–æ–∑–¥–∞—Ç—å –∞–Ω–∫–µ—Ç—É –≤ –¥—Ä—É–≥–æ–º –±—Ä–∞—É–∑–µ—Ä–µ –Ω–∞ —Ç–æ–º –∂–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ:**
   - –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ –¥—Ä—É–≥–æ–º –±—Ä–∞—É–∑–µ—Ä–µ
   - –ü–æ–ø—ã—Ç–∞—Ç—å—Å—è —Å–æ–∑–¥–∞—Ç—å –∞–Ω–∫–µ—Ç—É
   - ‚ùå –î–æ–ª–∂–Ω–æ –±—ã—Ç—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ

4. **–ü–æ–ø—ã—Ç–∫–∞ —Å–æ–∑–¥–∞—Ç—å –∞–Ω–∫–µ—Ç—É –Ω–∞ –¥—Ä—É–≥–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ:**
   - –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ –¥—Ä—É–≥–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
   - –°–æ–∑–¥–∞—Ç—å –∞–Ω–∫–µ—Ç—É
   - ‚úÖ –î–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∞–Ω–∫–µ—Ç
- –†–∞–±–æ—Ç–∞–µ—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –±—Ä–∞—É–∑–µ—Ä–∞
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å (—Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ)

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
- –ú–æ–∂–Ω–æ –æ–±–æ–π—Ç–∏, –∏–∑–º–µ–Ω–∏–≤ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –±—Ä–∞—É–∑–µ—Ä–∞
- –ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ VPN/–ø—Ä–æ–∫—Å–∏
- –ú–æ–∂–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ª–µ–≥–∏—Ç–∏–º–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –æ–±—â–∏—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤

## –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### –ü—Ä–æ—Å–º–æ—Ç—Ä –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
```python
# –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
devices = Device.query.all()

# –ü–æ–ª—É—á–∏—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Å –∞–Ω–∫–µ—Ç–∞–º–∏
devices_with_profiles = Device.query.filter(Device.profile_id.isnot(None)).all()

# –ü–æ–ª—É—á–∏—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –ø–æ –æ—Ç–ø–µ—á–∞—Ç–∫—É
device = Device.query.filter_by(device_fingerprint=fingerprint).first()
```

### –£–¥–∞–ª–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
```python
# –£–¥–∞–ª–∏—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ (—Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –∞–Ω–∫–µ—Ç—ã)
device = Device.query.filter_by(device_fingerprint=fingerprint).first()
if device:
    device.profile_id = None
    db.session.commit()
```

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –õ–æ–≥–∏
–°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä—É–µ—Ç:
- –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–ø–µ—á–∞—Ç–∫–æ–≤ —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- –ü–æ–ø—ã—Ç–∫–∏ —Å–æ–∑–¥–∞–Ω–∏—è –∞–Ω–∫–µ—Ç
- –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º

### –ú–µ—Ç—Ä–∏–∫–∏
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ —Å –∞–Ω–∫–µ—Ç–∞–º–∏
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫

## –û–±–Ω–æ–≤–ª–µ–Ω–∏—è

### –í–µ—Ä—Å–∏—è 1.0
- –ë–∞–∑–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ—Ç–ø–µ—á–∞—Ç–∫–æ–≤ —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–∞ –æ–¥–Ω—É –∞–Ω–∫–µ—Ç—É –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ
- API –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
- –¢–µ—Å—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞

### –ü–ª–∞–Ω—ã –Ω–∞ –±—É–¥—É—â–µ–µ
- –ë–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –æ—Ç–ø–µ—á–∞—Ç–∫–æ–≤
- –í—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
- –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å
- –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º