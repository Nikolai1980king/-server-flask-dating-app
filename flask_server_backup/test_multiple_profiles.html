<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>–¢–µ—Å—Ç —Å–æ–∑–¥–∞–Ω–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∞–Ω–∫–µ—Ç</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #0c0c0c 0%, #1a1a2e 25%, #16213e 50%, #0f3460 75%, #533483 100%);
            color: white;
        }
        .test-section {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .button {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px 5px;
            font-size: 16px;
        }
        .button:hover {
            background: linear-gradient(45deg, #45a049, #4CAF50);
        }
        .button.danger {
            background: linear-gradient(45deg, #f44336, #da190b);
        }
        .button.danger:hover {
            background: linear-gradient(45deg, #da190b, #f44336);
        }
        .info {
            background: rgba(0, 123, 255, 0.2);
            border: 1px solid rgba(0, 123, 255, 0.5);
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .success {
            background: rgba(40, 167, 69, 0.2);
            border: 1px solid rgba(40, 167, 69, 0.5);
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .error {
            background: rgba(220, 53, 69, 0.2);
            border: 1px solid rgba(220, 53, 69, 0.5);
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .log {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.2);
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
            max-height: 300px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <h1>üß™ –¢–µ—Å—Ç —Å–æ–∑–¥–∞–Ω–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∞–Ω–∫–µ—Ç</h1>
    
    <div class="test-section">
        <h2>üìã –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–µ–∫—É—â–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏</h2>
        <div class="info">
            <strong>–°—Ç–∞—Ç—É—Å:</strong> <span id="status">–ü—Ä–æ–≤–µ—Ä—è–µ–º...</span><br>
            <strong>–¢–µ–∫—É—â–∏–π user_id cookie:</strong> <span id="current-cookie">–ü—Ä–æ–≤–µ—Ä—è–µ–º...</span><br>
            <strong>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–Ω–∫–µ—Ç –≤ –±–∞–∑–µ:</strong> <span id="profile-count">–ü—Ä–æ–≤–µ—Ä—è–µ–º...</span>
        </div>
        
        <button class="button" onclick="checkStatus()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å</button>
        <button class="button" onclick="clearCookie()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å cookie</button>
        <button class="button" onclick="checkDatabase()">üìä –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö</button>
    </div>

    <div class="test-section">
        <h2>üéØ –¢–µ—Å—Ç —Å–æ–∑–¥–∞–Ω–∏—è –∞–Ω–∫–µ—Ç</h2>
        <div class="info">
            <strong>–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:</strong> –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–æ–∑–¥–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∞–Ω–∫–µ—Ç –ø–æ–¥—Ä—è–¥, —á—Ç–æ–±—ã —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ.
        </div>
        
        <button class="button" onclick="goToCreate()">‚ûï –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∞–Ω–∫–µ—Ç—É</button>
        <button class="button" onclick="goToHome()">üè† –ù–∞ –≥–ª–∞–≤–Ω—É—é</button>
    </div>

    <div class="test-section">
        <h2>üìù –õ–æ–≥ –æ–ø–µ—Ä–∞—Ü–∏–π</h2>
        <div id="log" class="log"></div>
        <button class="button" onclick="clearLog()">üßπ –û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥</button>
    </div>

    <script>
        function log(message, type = 'info') {
            const logDiv = document.getElementById('log');
            const timestamp = new Date().toLocaleTimeString();
            const color = type === 'error' ? '#ff6b6b' : type === 'success' ? '#51cf66' : '#74c0fc';
            logDiv.innerHTML += `<div style="color: ${color}">[${timestamp}] ${message}</div>`;
            logDiv.scrollTop = logDiv.scrollHeight;
        }

        function clearLog() {
            document.getElementById('log').innerHTML = '';
        }

        function getCookie(name) {
            const value = `; ${document.cookie}`;
            const parts = value.split(`; ${name}=`);
            if (parts.length === 2) return parts.pop().split(';').shift();
            return null;
        }

        function checkStatus() {
            const cookie = getCookie('user_id');
            document.getElementById('current-cookie').textContent = cookie || '–ù–µ—Ç cookie';
            document.getElementById('status').textContent = cookie ? '–ï—Å—Ç—å –∞–∫—Ç–∏–≤–Ω–∞—è —Å–µ—Å—Å–∏—è' : '–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ–π —Å–µ—Å—Å–∏–∏';
            log(`–ü—Ä–æ–≤–µ—Ä–µ–Ω —Å—Ç–∞—Ç—É—Å: ${cookie ? '–ï—Å—Ç—å cookie' : '–ù–µ—Ç cookie'}`);
        }

        function clearCookie() {
            document.cookie = 'user_id=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;';
            log('Cookie –æ—á–∏—â–µ–Ω', 'success');
            checkStatus();
        }

        async function checkDatabase() {
            try {
                const response = await fetch('/api/profiles');
                const data = await response.json();
                document.getElementById('profile-count').textContent = data.count || '–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö';
                log(`–ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö: ${data.count} –∞–Ω–∫–µ—Ç`, 'success');
            } catch (error) {
                log(`–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö: ${error.message}`, 'error');
            }
        }

        function goToCreate() {
            log('–ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å–æ–∑–¥–∞–Ω–∏—è –∞–Ω–∫–µ—Ç—ã');
            window.location.href = '/create';
        }

        function goToHome() {
            log('–ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É');
            window.location.href = '/';
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.onload = function() {
            log('–°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞');
            checkStatus();
            checkDatabase();
        };
    </script>
</body>
</html> 